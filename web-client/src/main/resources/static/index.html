<!DOCTYPE html>
<html>
<head>
	<title>Java Pet Store</title>
	<link rel="stylesheet" type="text/css" href="styles.css">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
<script type="text/javascript">
    var socket;
    var i = 0;
    function connectoToWebsocket(url) {
        if (!window.WebSocket) {
            window.WebSocket = window.MozWebSocket;
        }
        if (window.WebSocket) {
            socket = new WebSocket(url);
            socket.onmessage = function (event) {
                var ta = document.getElementById('responseText');
                ta.value = ta.value + '\n' + event.data
            };
            socket.onopen = function (event) {
                var ta = document.getElementById('responseText');
                ta.value = "Web Socket opened!";
                document.getElementById('message').removeAttribute("disabled");
                document.getElementById('sendButton').removeAttribute("disabled");
            };
            socket.onclose = function (event) {
                var ta = document.getElementById('responseText');
                ta.value = ta.value + "Web Socket closed";
            };
        } else {
            alert("Your browser does not support Web Socket.");
        }
    }
    function send(message) {
        if (!window.WebSocket) {
            return;
        }
        if (socket.readyState == WebSocket.OPEN) {
            /*var msg = JSON.stringify({
                "token": i++ + " ",
                "type": "addToCart",
                "pet" : 
                {
                    "@type" : "Cat",
                    "name" : "Mew",
                    "value" : 14124,
                    "type" : "Siberian",
                    "id": i,
                }
            });*/
            /*var msg = JSON.stringify({
              "type": "requestInventory"
            });*/
            var msg = JSON.stringify({
              "type": "requestCart",
              "token": "test"
            });
            socket.send(msg);
        } else {
            alert("The socket is not open.");
        }
    }
</script>
<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
      <a class="navbar-brand" href="#">Java Pet Store</a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav">
        <li class="active"><a href="#">Home</a></li>
        <li><a href="#">Pets</a></li>
      </ul>
	  <ul class="nav navbar-nav navbar-right">
		<li><a href="#"><span class="glyphicon glyphicon-shopping-cart"></span> Shopping cart</a></li>
		<li><a href="#"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
        <li><a href="#"><span class="glyphicon glyphicon-log-in"></span> Register</a></li>
      </ul>
    </div>
  </div>
</nav>

<div class="container-fluid text-center">    
  <div class="row content">
    <div class="col-md-8 col-md-offset-2 text-left"> 
		<h1>Welcome</h1>
		<form onsubmit="return false;">
			<input name="url" value="ws://localhost:9292/websocket"/>
			<input type="button" value="Connect" onclick="connectoToWebsocket(this.form.url.value)"/> <br/>

			<input type="text" name="message" id="message" value="Hello, World!" disabled="disabled"/>
			<input type="button" id="sendButton" name="sendButton" value="Send Web Socket Data" onclick="send(this.form.message.value)"
			disabled="disabled"/>

			<h3>Output</h3>
			<textarea id="responseText" style="width:500px;height:300px;"></textarea>
		</form>
    </div>
  </div>
</div>
</body>
</html>